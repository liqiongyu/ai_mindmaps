## 1. OpenSpec

- [x] 1.1 Define context format per scope

## 2. Implementation

- [x] 2.1 Add helpers to build global outline + node scope context
- [x] 2.2 Update `/api/ai/chat` to use slimmed context payload
- [x] 2.3 Keep behavior stable for small maps

## 3. Tests

- [x] 3.1 Unit tests for context builder (size + content assertions)

## 4. Verification

- [x] 4.1 Verify `pnpm -s format:check`, `pnpm -s lint`, `pnpm -s typecheck`, `pnpm -s test`
